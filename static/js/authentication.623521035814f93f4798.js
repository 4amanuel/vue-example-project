webpackJsonp([12],{"5zde":function(e,n,t){t("zQR9"),t("qyJz"),e.exports=t("FeBl").Array.from},"8bnN":function(e,n,t){"use strict";n.a={props:{title:{type:String,default:""}},data:function(){return{}},methods:{}}},"8l3q":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("gUUB"),s=t("fVzj"),a=t("VU/8"),o=a(r.a,s.a,null,null,null);n.default=o.exports},"Mn9/":function(e,n,t){"use strict";function r(e){t("Sq6U")}var s=t("8bnN"),a=t("VL4h"),o=t("VU/8"),i=r,u=o(s.a,a.a,i,null,null);n.a=u.exports},Sq6U:function(e,n,t){var r=t("fcGQ");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("7ecc9016",r,!0)},VL4h:function(e,n,t){"use strict";var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"my-back-nav"},[t("div",{staticClass:"container"},[t("nav",{staticClass:"navbar"},[t("div",{staticClass:"navbar-brand"},[t("router-link",{staticClass:"navbar-item my-brand",attrs:{to:{name:"overview"}}},[t("b-icon",{attrs:{icon:"arrow_back",type:"is-white"}})],1),t("div",{staticClass:"navbar-item subtitle has-text-white"},[e._v(e._s(e.title))])],1)])])])},s=[],a={render:r,staticRenderFns:s};n.a=a},"c/Tr":function(e,n,t){e.exports={default:t("5zde"),__esModule:!0}},fBQ2:function(e,n,t){"use strict";var r=t("evD5"),s=t("X8DO");e.exports=function(e,n,t){n in e?r.f(e,n,s(0,t)):e[n]=t}},fVzj:function(e,n,t){"use strict";var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"my-node-page"},[t("main",[t("back-nav",{attrs:{title:"Authentication"}}),e._m(0)],1),t("main-footer")],1)},s=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",{staticClass:"section"},[t("div",{staticClass:"container"},[t("div",{staticClass:"content"},[e._v("In this section of the tutorial we'll look at Pug (previously known as Jade) as a replacement\ntemplate language for HTML...")]),t("div",{staticClass:"title is-4"},[e._v("The Auth Plugin")]),t("pre",{staticClass:"block"},[t("code",{staticClass:"hljs javascript"},[e._v("import Vue from 'vue'\nimport router from './router'\nimport store from './store'\n\n/**\n* @var{string} LOGIN_URL The endpoint for logging in. This endpoint should be proxied by Webpack dev server\n*    and maybe nginx in production (cleaner calls and avoids CORS issues).\n*/\nconst LOGIN_URL = '/auth'\n\n/**\n* @var{string} REFRESH_TOKEN_URL The endpoint for refreshing an access_token. This endpoint should be proxied\n*    by Webpack dev server and maybe nginx in production (cleaner calls and avoids CORS issues).\n*/\nconst REFRESH_TOKEN_URL = '/auth'\n\n/**\n* TODO: This is here to demonstrate what an OAuth server will want. Ultimately you don't want to\n* expose a client_secret here. You want your real project backend to take a username/password\n* request and add the client secret on the server-side and forward that request\n* onto an OAuth server. Your backend acts as a middle-man in the process, which is better, for\n* example in situations like DDoS attacks.\n*\n* @var{Object} AUTH_BASIC_HEADERS The options to pass into a Vue-resource http call. Includes\n*    the headers used for login and token refresh and emulateJSON flag since we are hitting an\n*    OAuth server directly that can't handle application/json.\n*/\nconst AUTH_BASIC_HEADERS = {\n  headers: {\n    'Authorization': 'Basic ZGVtb2FwcDpkZW1vcGFzcw==' // Base64(client_id:client_secret) \"demoapp:demopass\"\n  },\n  emulateJSON: true\n}\n\n/**\n* Auth Plugin\n*\n* (see https://vuejs.org/v2/guide/plugins.html for more info on Vue.js plugins)\n*\n* Handles login and token authentication using OAuth2.\n*/\nexport default {\n\n  /**\n  * Install the Auth class.\n  *\n  * Creates a Vue-resource http interceptor to handle automatically adding auth headers\n  * and refreshing tokens. Then attaches this object to the global Vue (as Vue.auth).\n  *\n  * @param {Object} Vue The global Vue.\n  * @param {Object} options Any options we want to have in our plugin.\n  * @return {void}\n  */\n  install (Vue, options) {\n    Vue.http.interceptors.push((request, next) => {\n      const token = store.state.auth.accessToken\n      const hasAuthHeader = request.headers.has('Authorization')\n\n      if (token && !hasAuthHeader) {\n        this.setAuthHeader(request)\n      }\n\n      next((response) => {\n        if (this._isInvalidToken(response)) {\n          return this._refreshToken(request)\n        }\n      })\n    })\n\n    Vue.prototype.$auth = Vue.auth = this\n  },\n\n  /**\n  * Login\n  *\n  * @param {Object.<string>} creds The username and password for logging in.\n  * @param {string|null} redirect The name of the Route to redirect to.\n  * @return {Promise}\n  */\n  login (creds, redirect) {\n    const params = { 'grant_type': 'password', 'username': creds.username, 'password': creds.password }\n\n    return Vue.http.post(LOGIN_URL, params, AUTH_BASIC_HEADERS)\n      .then((response) => {\n        this._storeToken(response)\n\n        if (redirect) {\n          router.push({ name: redirect })\n        }\n\n        return response\n      })\n      .catch((errorResponse) => {\n        return errorResponse\n      })\n  },\n\n  /**\n  * Logout\n  *\n  * Clear all data in our Vuex store (which resets logged-in status) and redirect back\n  * to login form.\n  *\n  * @return {void}\n  */\n  logout () {\n    store.commit('CLEAR_ALL_DATA')\n    router.push({ name: 'login' })\n  },\n\n  /**\n  * Set the Authorization header on a Vue-resource Request.\n  *\n  * @param {Request} request The Vue-Resource Request instance to set the header on.\n  * @return {void}\n  */\n  setAuthHeader (request) {\n    request.headers.set('Authorization', 'Bearer ' + store.state.auth.accessToken)\n    // The demo Oauth2 server we are using requires this param, but normally you only set the header.\n    /* eslint-disable camelcase */\n    request.params.access_token = store.state.auth.accessToken\n  },\n\n  /**\n  * Retry the original request.\n  *\n  * Let's retry the user's original target request that had recieved a invalid token response\n  * (which we fixed with a token refresh).\n  *\n  * @param {Request} request The Vue-resource Request instance to use to repeat an http call.\n  * @return {Promise}\n  */\n  _retry (request) {\n    this.setAuthHeader(request)\n\n    return Vue.http(request)\n      .then((response) => {\n        return response\n      })\n      .catch((response) => {\n        return response\n      })\n  },\n\n  /**\n  * Refresh the access token\n  *\n  * Make an ajax call to the OAuth2 server to refresh the access token (using our refresh token).\n  *\n  * @private\n  * @param {Request} request Vue-resource Request instance, the original request that we'll retry.\n  * @return {Promise}\n  */\n  _refreshToken (request) {\n    const params = { 'grant_type': 'refresh_token', 'refresh_token': store.state.auth.refreshToken }\n\n    return Vue.http.post(REFRESH_TOKEN_URL, params, AUTH_BASIC_HEADERS)\n      .then((result) => {\n        this._storeToken(result)\n        return this._retry(request)\n      })\n      .catch((errorResponse) => {\n        if (this._isInvalidToken(errorResponse)) {\n          this.logout()\n        }\n        return errorResponse\n      })\n  },\n\n  /**\n  * Store tokens\n  *\n  * Update the Vuex store with the access/refresh tokens received from the response from\n  * the Oauth2 server.\n  *\n  * @private\n  * @param {Response} response Vue-resource Response instance from an OAuth2 server.\n  *      that contains our tokens.\n  * @return {void}\n  */\n  _storeToken (response) {\n    const auth = store.state.auth\n    const user = store.state.user\n\n    auth.isLoggedIn = true\n    auth.accessToken = response.body.access_token\n    auth.refreshToken = response.body.refresh_token\n    // TODO: get user's name from response from Oauth server.\n    user.name = 'John Smith'\n\n    store.commit('UPDATE_AUTH', auth)\n    store.commit('UPDATE_USER', user)\n  },\n\n  /**\n  * Check if the Vue-resource Response is an invalid token response.\n  *\n  * @private\n  * @param {Response} response The Vue-resource Response instance received from an http call.\n  * @return {boolean}\n  */\n  _isInvalidToken (response) {\n    const status = response.status\n    const error = response.data.error\n\n    return (status === 401 && (error === 'invalid_token' || error === 'expired_token'))\n  }\n}\n\n")])])])])}],a={render:r,staticRenderFns:s};n.a=a},fcGQ:function(e,n,t){n=e.exports=t("FZ+f")(!0),n.push([e.i,"#app .my-back-nav{border-bottom:1px solid hsla(0,0%,100%,.5)}#app .my-back-nav,#app .my-back-nav .navbar{background-color:#00bda0}#app .my-back-nav .navbar-item:hover .icon>i,#app .my-back-nav .navbar-item:hover>.navbar-link,#app .my-back-nav .navbar-item:hover>a{color:#0a0a0a}","",{version:3,sources:["/home/david/projects/code/vue-example-project/src/features/common/back-nav.vue"],names:[],mappings:"AACA,kBAEE,0CAA+C,CAChD,AACD,4CAHE,wBAA0B,CAK3B,AACD,sIAGE,aAAe,CAChB",file:"back-nav.vue",sourcesContent:["\n#app .my-back-nav {\n  background-color: #00bda0;\n  border-bottom: 1px solid rgba(255,255,255,0.5);\n}\n#app .my-back-nav .navbar {\n  background-color: #00bda0;\n}\n#app .my-back-nav .navbar-item:hover > a,\n#app .my-back-nav .navbar-item:hover > .navbar-link,\n#app .my-back-nav .navbar-item:hover .icon > i {\n  color: #0a0a0a;\n}"],sourceRoot:""}])},gUUB:function(e,n,t){"use strict";var r=t("c/Tr"),s=t.n(r),a=t("Mn9/");n.a={name:"authentication",components:{BackNav:a.a},mounted:function(){var e=this,n=s()(document.getElementsByClassName("title")),t=n.filter(function(n){return n.innerHTML===e.$route.query.title})[0];t?t.scrollIntoView():scroll(0,0)},data:function(){return{}},methods:{}}},qyJz:function(e,n,t){"use strict";var r=t("+ZMJ"),s=t("kM2E"),a=t("sB3e"),o=t("msXi"),i=t("Mhyx"),u=t("QRG4"),c=t("fBQ2"),h=t("3fs2");s(s.S+s.F*!t("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var n,t,s,l,p=a(e),d="function"==typeof this?this:Array,v=arguments.length,m=v>1?arguments[1]:void 0,f=void 0!==m,k=0,b=h(p);if(f&&(m=r(m,v>2?arguments[2]:void 0,2)),void 0==b||d==Array&&i(b))for(n=u(p.length),t=new d(n);n>k;k++)c(t,k,f?m(p[k],k):p[k]);else for(l=b.call(p),t=new d;!(s=l.next()).done;k++)c(t,k,f?o(l,m,[s.value,k],!0):s.value);return t.length=k,t}})}});
//# sourceMappingURL=authentication.623521035814f93f4798.js.map